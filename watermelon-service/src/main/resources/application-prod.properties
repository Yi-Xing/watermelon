# 环境标识
env=prod
debug=false

# Tomcat 配置
server.port=8080
server.servlet.context-path=/
server.tomcat.max-connections=500
server.tomcat.threads.max=200
server.tomcat.connection-timeout=20000

# 日志配置
logging.config=classpath:log4j2-prod.xml

# MySQL 数据源配置 (生产环境 - Druid 连接池)
spring.datasource.type=com.alibaba.druid.pool.DruidDataSource
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://your-prod-mysql-host:3306/watermelon_prod?useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=Asia/Shanghai
spring.datasource.username=${DB_USERNAME:watermelon_prod}
spring.datasource.password=${DB_PASSWORD:your_prod_password}

# Druid 连接池配置 (生产环境优化)
# 初始连接数：生产环境使用更大的初始连接数，减少启动时的等待
spring.datasource.druid.initial-size=20
# 最小空闲连接数：保持更多空闲连接以应对突发流量
spring.datasource.druid.min-idle=20
# 最大活跃连接数：生产环境支持更多并发连接
spring.datasource.druid.max-active=100
# 获取连接最大等待时间：连接池满时的最大等待时间（毫秒）
spring.datasource.druid.max-wait=60000
# 空闲连接检测间隔：定期检测空闲连接的时间间隔（毫秒）
spring.datasource.druid.time-between-eviction-runs-millis=60000
# 连接最小空闲时间：连接在池中的最小空闲时间，超过将被回收（毫秒）
spring.datasource.druid.min-evictable-idle-time-millis=300000
# 连接有效性检测SQL：用于检测连接是否有效的SQL语句
spring.datasource.druid.validation-query=SELECT 1 FROM DUAL
# 空闲时检测连接：空闲时检测连接有效性，确保连接可用
spring.datasource.druid.test-while-idle=true
# 获取连接时检测：获取连接时不检测，提高性能
spring.datasource.druid.test-on-borrow=false
# 归还连接时检测：归还连接时不检测，提高性能
spring.datasource.druid.test-on-return=false
# 过滤器配置：启用统计、防火墙、slf4j日志过滤器（生产环境使用slf4j）
spring.datasource.druid.filters=stat,wall,slf4j
# 监控页面：生产环境禁用监控页面，提高安全性
spring.datasource.druid.stat-view-servlet.enabled=false
# Web统计过滤器：启用Web应用统计功能
spring.datasource.druid.web-stat-filter.enabled=true
# Web统计过滤器路径：统计所有请求
spring.datasource.druid.web-stat-filter.url-pattern=/*
# Web统计过滤器排除项：排除静态资源和监控页面
spring.datasource.druid.web-stat-filter.exclusions=*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*

# MyBatis Plus 配置
mybatis-plus.configuration.map-underscore-to-camel-case=true
mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.nologging.NoLoggingImpl
mybatis-plus.mapper-locations=classpath*:/mapper/**/*.xml
mybatis-plus.type-aliases-package=top.fblue.watermelon.infrastructure.po

# MyBatis Plus 逻辑删除配置
mybatis-plus.global-config.db-config.logic-delete-field=isDeleted
mybatis-plus.global-config.db-config.logic-delete-value=1
mybatis-plus.global-config.db-config.logic-not-delete-value=0

# MyBatis Plus ID生成策略
mybatis-plus.global-config.db-config.id-type=auto

# Redis配置 (生产环境)
spring.data.redis.host=${REDIS_HOST:your-prod-redis-host}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.timeout=30000ms
spring.data.redis.password=${REDIS_PASSWORD:your_redis_password}
spring.data.redis.lettuce.pool.min-idle=10
spring.data.redis.lettuce.pool.max-active=50
spring.data.redis.lettuce.pool.max-wait=-1ms
spring.data.redis.lettuce.pool.max-idle=20
